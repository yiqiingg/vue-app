{"remainingRequest":"/Users/yiqing/Downloads/vue-test/redo-mapbox-app/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yiqing/Downloads/vue-test/redo-mapbox-app/src/components/EmployeeForm.vue?vue&type=style&index=0&id=81b3487c&scoped=true&lang=css&","dependencies":[{"path":"/Users/yiqing/Downloads/vue-test/redo-mapbox-app/src/components/EmployeeForm.vue","mtime":1632777350946},{"path":"/Users/yiqing/Downloads/vue-test/redo-mapbox-app/node_modules/css-loader/dist/cjs.js","mtime":1632429635351},{"path":"/Users/yiqing/Downloads/vue-test/redo-mapbox-app/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1632429636569},{"path":"/Users/yiqing/Downloads/vue-test/redo-mapbox-app/node_modules/postcss-loader/src/index.js","mtime":1632429635993},{"path":"/Users/yiqing/Downloads/vue-test/redo-mapbox-app/node_modules/cache-loader/dist/cjs.js","mtime":1632429635085},{"path":"/Users/yiqing/Downloads/vue-test/redo-mapbox-app/node_modules/vue-loader/lib/index.js","mtime":1632429636569}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCmZvcm0gewogIG1hcmdpbi1ib3R0b206IDJyZW07Cn0KW2NsYXNzKj0nLW1lc3NhZ2UnXSB7CiAgZm9udC13ZWlnaHQ6IDUwMDsKfQouZXJyb3ItbWVzc2FnZSB7CiAgY29sb3I6ICNkMzNjNDA7Cn0KLnN1Y2Nlc3MtbWVzc2FnZSB7CiAgY29sb3I6ICMzMmE5NWQ7Cn0K"},{"version":3,"sources":["EmployeeForm.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"EmployeeForm.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div id=\"employee-form\">\n    <label>Shapefile upload</label>\n    <!-- <form @submit.prevent=\"checkUploadStatus\">\n      <button>Check</button>\n    </form> -->\n    <form\n      class=\"upload\"\n      @submit.prevent=\"handleFileSubmit\"\n      @change=\"previewFiles\"\n    >\n      <label>File Name</label>\n      <!-- <input type=\"text\" /> -->\n      <input v-model=\"shapefiles.name\" type=\"text\" />\n      <input type=\"file\" name=\"uploadFile\" accept=\".zip\" required />\n      <br /><br />\n      <input type=\"submit\" />\n    </form>\n    <div id=\"map-component\" />\n  </div>\n</template>\n\n<script>\nlet tilesetid;\nconst MY_ACCESS_TOKEN =\n  'sk.eyJ1IjoieWlxaW5nZ2dnIiwiYSI6ImNrdHhma3ZiYzBrMXQybnRoemFkOTlhMW4ifQ.Fe0XhvYKsc5A9MmE8xD7OQ';\nconst mbxUploads = require('@mapbox/mapbox-sdk/services/uploads');\nconst mbxClient = require('@mapbox/mapbox-sdk');\nconst baseClient = mbxClient({ accessToken: MY_ACCESS_TOKEN });\nconst uploadsClient = mbxUploads(baseClient);\n// let uploadId;\nimport mapboxgl from 'mapbox-gl';\nconst AWS = require('aws-sdk');\nmapboxgl.accessToken =\n  'pk.eyJ1IjoieWlxaW5nZ2dnIiwiYSI6ImNrdHkwM2w1cTJ5dWgydnBtdWx4MXFlN3EifQ.WoSz2Zn-h7SkdDmouxC0XQ';\nexport default {\n  name: 'employee-form',\n  data() {\n    return {\n      submiting: false,\n      error: false,\n      success: false,\n      shapefiles: {\n        name: '',\n        id: '',\n      },\n      selectedFile: null,\n    };\n  },\n  methods: {\n    async onPickFile() {\n      this.$refs.fileInput.click();\n    },\n    // async checkUploadStatus() {\n    //   await uploadsClient\n    //     .getUpload({\n    //       uploadId: uploadId,\n    //     })\n    //     .send()\n    //     .then((response) => {\n    //       const status = response.body;\n    //       console.log(status);\n    //     });\n    // },\n    async handleFileSubmit() {\n      console.log('starting upload...');\n      // console.log(event.target.files);\n      // import * as fs from 'fs';\n      const getCredentials = () => {\n        return uploadsClient\n          .createUploadCredentials()\n          .send()\n          .then((response) => response.body);\n      };\n      const putFileOnS3 = (credentials) => {\n        const s3 = new AWS.S3({\n          accessKeyId: credentials.accessKeyId,\n          secretAccessKey: credentials.secretAccessKey,\n          sessionToken: credentials.sessionToken,\n          region: 'us-east-1',\n        });\n        return s3\n          .putObject({\n            Bucket: credentials.bucket,\n            Key: credentials.key,\n            Body: this.selectedFile,\n            // Body: fs.createReadStream('/path/to/file.mbtiles')\n          })\n          .promise();\n      };\n      // console.log(await getCredentials());\n      // let credentials = await getCredentials();\n      // console.log(credentials);\n      // credentials = putFileOnS3(credentials);\n      // response.then(console.log);\n      // response.then((res) => console.log(res));\n      const credentials = await getCredentials();\n      putFileOnS3(credentials);\n      const myUsername = 'yiqingggg';\n      const myTileset = 'myTileset2';\n      // const credentials = uploadsClient.createUploadCredentials();\n      console.log(credentials);\n      uploadsClient\n        .createUpload({\n          tileset: `${myUsername}.${myTileset}`,\n          url:\n            'https://tilestream-tilesets-production.s3.amazonaws.com/f9/_pending/ojdxb7tykp82x1s3nceqyxtkc/yiqingggg',\n          name: 'JMLQ UPLOAD1',\n        })\n        .send()\n        .then((response) => {\n          const upload = response.body;\n          console.log(upload, upload.tileset);\n          tilesetid = upload.tileset;\n          // uploadId = response.body.id;\n        });\n      // await uploadsClient\n      //   .getUpload({\n      //     uploadId: uploadId,\n      //   })\n      //   .send()\n      //   .then((response) => {\n      //     const status = response.body;\n      //     console.log(status);\n      //   });\n      console.log('done');\n      const map = new mapboxgl.Map({\n        container: 'map-component', // container ID\n        style: 'mapbox://styles/mapbox/streets-v11', // style URL\n        center: [-122.272781, 37.871666], // starting position [lng, lat]\n        zoom: 15, // starting zoom\n      });\n      console.log(tilesetid);\n      map.on('load', () => {\n        map.addSource('parks', {\n          type: 'vector',\n          url: `mapbox://yiqingggg.myTileset2`,\n        });\n        map.addLayer({\n          id: 'parks',\n          type: 'line',\n          source: 'parks',\n          'source-layer': 'JMLQ UPLOAD1',\n          layout: {\n            // Make the layer visible by default.\n            visibility: 'visible',\n            'line-join': 'round',\n            'line-cap': 'round',\n          },\n          paint: {\n            'line-color': '#877b59',\n            'line-width': 20,\n          },\n        });\n      });\n    },\n    // async onFilePicked (event) {\n    //   const files = event.target.files\n    //   let filename = files[0].name\n    //   const fileReader = new FileReader()\n    //   fileReader.addEventListener('load', () => {\n    //     this.imageUrl = fileReader.result\n    //   })\n    //   fileReader.readAsDataURL(files[0])\n    //   this.image = files[0]\n    //   console.log(filename);\n    //   await handleFileSubmit(this.image);\n    // },\n    async previewFiles(event) {\n      this.selectedFile = event.target.files[0];\n    },\n    handleSubmit() {\n      console.log('testing handleSubmit');\n      this.submitting = true;\n      this.clearStatus();\n      if (this.invalidName || this.invalidEmail) {\n        this.error = true;\n        return;\n      }\n      this.$emit('add:employee', this.employee);\n      this.$refs.first.focus();\n      this.employee = {\n        name: '',\n        email: '',\n      };\n      this.error = false;\n      this.success = true;\n      this.submitting = false;\n    },\n    clearStatus() {\n      this.success = false;\n      this.error = false;\n    },\n  },\n};\n//   export default {\n//     name: 'employee-form',\n//     data() {\n//       return {\n//         employee: {\n//           name: '',\n//           email: '',\n//         },\n//       }\n//     },\n//     methods: {\n//         handleSubmit() {\n//             console.log('testing handleSubmit')\n//         },\n//     },\n//   }\n</script>\n\n<style scoped>\nform {\n  margin-bottom: 2rem;\n}\n[class*='-message'] {\n  font-weight: 500;\n}\n.error-message {\n  color: #d33c40;\n}\n.success-message {\n  color: #32a95d;\n}\n</style>\n"]}]}